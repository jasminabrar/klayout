This text file outlines how to use klayout with embedded gds factory on Mac M1 by using a linux (ubuntu 22) VM in UTM. UTM is a virtualization software for macOS and only for Apple platforms.

As of 10/04/2023 these instructions are incomplete as I am still working through some bugs. These instructions will allow you to create a VM up to date with where I am with embedding gds factory in klayout.

Instructions
- create linux VM by following the tutorial video: https://www.youtube.com/watch?v=6mtfncj9vhU

- if experiencing issues connecting to the internet on VM:
	- Shut off VM -> VM settings in UTM (click on VM, click icon top right corner) -> Network -> change 	  Network Mode to ‘Emulated VAN’

- fork klayout GitHub repo, git clone repo 

- install all required packages to build klayout on linux (refer to https://www.klayout.de/build.html): 
	sudo apt-get update
	sudo apt-get install build-essential
	sudo apt-get install qtbase5-dev qttools5-dev libqt5xmlpatterns5-dev qtmultimedia5-dev 	  libqt5multimediawidgets5 libqt5svg5-dev
	sudo apt-get install ruby ruby-dev
	sudo apt-get install python3 python3-dev
	sudo apt-get install zlib1g-dev

- navigate to cloned klayout repo

- run build script:
	./build.sh

- install remaining gdstk dependencies that may not be already installed (refer to https://github.com/heitzmann/gdstk):
	sudo apt-get install qhull-bin
	sudo apt-get install cmake
	pip install numpy
	pip install sphinx

- pip install gplugins

- pip install gdsfactory

- navigate to bin-release folder in klayout repo

- Fix symbolic link error that will prevent you from running klayout (note that this only fixes for the current session):
	export LD_LIBRARY_PATH=$(pwd):$LD_LIBRARY_PATH

	sudo ldconfig


- run klayout from command line:
	./klayout

- macros -> macro development -> import gdsfactory
	- ERROR here, I am working to resolve
